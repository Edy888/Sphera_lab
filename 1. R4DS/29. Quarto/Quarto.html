<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="rus" xml:lang="rus"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.433">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Edy888">

<title>QUARTO_information</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="Quarto_files/libs/clipboard/clipboard.min.js"></script>
<script src="Quarto_files/libs/quarto-html/quarto.js"></script>
<script src="Quarto_files/libs/quarto-html/popper.min.js"></script>
<script src="Quarto_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="Quarto_files/libs/quarto-html/anchor.min.js"></script>
<link href="Quarto_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="Quarto_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="Quarto_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="Quarto_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="Quarto_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script src="Quarto_files/libs/htmlwidgets-1.6.2/htmlwidgets.js"></script>
<script src="Quarto_files/libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<link href="Quarto_files/libs/leaflet-1.3.1/leaflet.css" rel="stylesheet">
<script src="Quarto_files/libs/leaflet-1.3.1/leaflet.js"></script>
<link href="Quarto_files/libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet">
<script src="Quarto_files/libs/proj4-2.6.2/proj4.min.js"></script>
<script src="Quarto_files/libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script>
<link href="Quarto_files/libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet">
<script src="Quarto_files/libs/leaflet-binding-2.2.0/leaflet.js"></script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">QUARTO_information</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Edy888 </p>
          </div>
  </div>
    
  
    
  </div>
  

</header>

<section id="quarto" class="level2">
<h2 class="anchored" data-anchor-id="quarto">1. Quarto</h2>
<section id="рендеринг" class="level3">
<h3 class="anchored" data-anchor-id="рендеринг">1.1 <strong>Рендеринг</strong></h3>
<p>это процесс преобразования исходных данных или информации в вид, который может быть отображен и воспринят. В контексте создания документов, веб-страниц, графики, анимации и других медиафайлов, рендеринг означает создание конечного визуального представления на основе исходных данных или описания.</p>
<p>Вот несколько примеров рендеринга в разных контекстах:</p>
<ol type="1">
<li><p><strong>Рендеринг веб-страниц:</strong> Когда вы посещаете веб-сайт, ваш браузер рендерит HTML-код, который определяет структуру и содержание страницы, визуально интерпретируя его и отображая на экране.</p></li>
<li><p><strong>Рендеринг изображений:</strong> Программа рендеринга изображений, такая как Adobe Photoshop, принимает исходные изображения, фильтры, слои и инструкции и создает конечное изображение, которое можно сохранить в файле.</p></li>
<li><p><strong>Рендеринг анимации:</strong> Создание анимированных фильмов или видеороликов включает в себя рендеринг каждого кадра анимации, который затем объединяется в единый видеоролик.</p></li>
<li><p><strong>Рендеринг документов:</strong> В создании отчетов и документации, рендеринг означает преобразование исходного текста, изображений и кода в желаемый формат вывода, такой как PDF, HTML, DOCX и другие.</p></li>
<li><p><strong>Рендеринг графики:</strong> Программы для создания графики, такие как библиотеки для рисования и моделирования 3D-графики, рендерят (отображают) визуальные элементы на экране или в рендеренных изображениях.</p></li>
</ol>
<p>Рендеринг может включать в себя различные этапы, включая обработку, интерпретацию и конечное воспроизведение данных. Этот процесс необходим для того, чтобы предоставить визуальное представление данных, информации или мультимедийного контента конечным пользователям.</p>
</section>
<section id="описание-quarto" class="level3">
<h3 class="anchored" data-anchor-id="описание-quarto">1.2 Описание Quarto</h3>
<ul>
<li>это относительно новый инструмент для рендеринга документов, который предоставляет богатые возможности для создания и публикации документов на разных языках, включая R и Python. Он позволяет вам создавать документы с живой кодовой ячейкой, поддерживая языки программирования, такие как R и Python, и интегрируя их в текстовый документ. Quarto предоставляет новый способ создания интерактивных и информативных документов, особенно для анализа данных и создания отчетов.</li>
</ul>
<section id="основные-особенности-quarto" class="level4">
<h4 class="anchored" data-anchor-id="основные-особенности-quarto">1.2.1 Основные особенности QUARTO:</h4>
<ol type="1">
<li><strong>Интерактивные кодовые ячейки:</strong> Вы можете вставлять кодовые ячейки непосредственно в документ и выполнять их прямо внутри документа, а результаты будут отображаться в живом режиме.</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> x<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x, y)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Quarto_files/figure-html/unnamed-chunk-1-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<ol start="2" type="1">
<li><strong>Интеграция с R и Python:</strong> Quarto позволяет вам использовать языки программирования R и Python и вставлять их код в документы.</li>
</ol>
<p><em>Для интеграции R и Python в Quarto, вы можете использовать кодовые ячейки для каждого языка. Вот пример, как это можно сделать:</em></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Это R-кодовая ячейка</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> x<span class="sc">^</span><span class="dv">2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Это Python-кодовая ячейка</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> [<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>]</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> [i<span class="op">**</span><span class="dv">2</span> <span class="cf">for</span> i <span class="kw">in</span> x]</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(x<span class="op">+</span>y)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1, 2, 3, 4, 5, 1, 4, 9, 16, 25]</code></pre>
</div>
</div>
<p>В этом примере представлена интеграция R и Python в одном документе Quarto. Вы можете использовать кодовые ячейки для каждого языка, и результаты их выполнения будут вставлены в документ.</p>
<ol start="3" type="1">
<li><p><strong>Поддержка разных языков:</strong> Quarto поддерживает несколько языков разметки, включая Markdown, LaTeX и AsciiDoc, что делает его гибким инструментом для создания документации и отчетов на разных языках.</p></li>
<li><p><strong>Множество форматов вывода:</strong> Вы можете легко преобразовать свои документы Quarto в разные форматы вывода, такие как HTML, PDF, DOCX, и другие.</p>
<p><strong>4.1 Настройки для HTML:</strong></p></li>
</ol>
<p>Чтобы настроить ваш документ для HTML-вывода, вы можете добавить следующий блок параметров YAML в начало вашего RMarkdown-документа: <code>output:html_document:toc: true</code></p>
<p><strong>4.2 PDF</strong>:</p>
<p>Для создания PDF-документа, вы можете использовать Latex как промежуточный формат. Вот пример YAML-блока для настройки PDF-вывода:<code>output:   pdf_document:     latex_engine: xelatex</code> В этом примере, <code>latex_engine</code> устанавливает движок Latex, который будет использоваться для компиляции документа в PDF.</p>
<p><strong>4.3 Настройки для DOCX</strong>:</p>
<p>Для создания документа Word DOCX, вы также можете использовать YAML-блок: <code>output:   word_document: default</code> Здесь <code>word_document</code> указывает, что вы хотите создать DOCX-документ.</p>
<ol start="5" type="1">
<li><strong>Поддержка публикации:</strong> Quarto обеспечивает интеграцию с различными платформами для публикации, такими как GitHub Pages и Netlify.</li>
</ol>
<p><strong>5.1 GitHub Pages</strong>:</p>
<p>Для публикации на GitHub Pages, убедитесь, что у вас есть репозиторий на GitHub и включена функция GitHub Pages для этого репозитория. Затем вы можете настроить ваш RMarkdown-документ для автоматической публикации на GitHub Pages, добавив следующий блок YAML в начале вашего документа:<code>output:   github_document:     repo: username/repo-name</code>Здесь <strong><code>username</code></strong> - это ваш логин на GitHub, а <strong><code>repo-name</code></strong> - название вашего репозитория. После настройки этого блока, когда вы рендерите ваш документ в Quarto, он будет автоматически опубликован на GitHub Pages.</p>
<p><strong>5.2 Netlify</strong>:</p>
<p>Netlify - это другая платформа для размещения статических сайтов. Для публикации на Netlify, вам нужно настроить ваш RMarkdown-документ для автоматической интеграции с Netlify. Это можно сделать, добавив файл <strong><code>netlify.toml</code></strong> в корневой каталог вашего проекта с указанием настроек. В <strong><code>netlify.toml</code></strong> вы можете указать команды сборки и развертывания.</p>
<p>Пример <strong><code>netlify.toml</code></strong>: <code>[build]   publish = "_site"   command = "quarto render --to html"</code></p>
<p>В этом примере, команда <strong><code>quarto render --to html</code></strong> будет использоваться для рендеринга вашего документа в формат HTML, и результат будет размещен в каталог <strong><code>_site</code></strong>. Затем Netlify автоматически развернет ваш проект.</p>
<ol start="6" type="1">
<li><strong>Возможности интерактивности:</strong> Quarto также поддерживает интерактивные графики, таблицы и другие элементы, которые делают ваши документы более динамичными и информативными.</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(nycflights13)</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>flights</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 336,776 × 19
    year month   day dep_time sched_dep_time dep_delay arr_time sched_arr_time
   &lt;int&gt; &lt;int&gt; &lt;int&gt;    &lt;int&gt;          &lt;int&gt;     &lt;dbl&gt;    &lt;int&gt;          &lt;int&gt;
 1  2013     1     1      517            515         2      830            819
 2  2013     1     1      533            529         4      850            830
 3  2013     1     1      542            540         2      923            850
 4  2013     1     1      544            545        -1     1004           1022
 5  2013     1     1      554            600        -6      812            837
 6  2013     1     1      554            558        -4      740            728
 7  2013     1     1      555            600        -5      913            854
 8  2013     1     1      557            600        -3      709            723
 9  2013     1     1      557            600        -3      838            846
10  2013     1     1      558            600        -2      753            745
# ℹ 336,766 more rows
# ℹ 11 more variables: arr_delay &lt;dbl&gt;, carrier &lt;chr&gt;, flight &lt;int&gt;,
#   tailnum &lt;chr&gt;, origin &lt;chr&gt;, dest &lt;chr&gt;, air_time &lt;dbl&gt;, distance &lt;dbl&gt;,
#   hour &lt;dbl&gt;, minute &lt;dbl&gt;, time_hour &lt;dttm&gt;</code></pre>
</div>
</div>
<p>RStudio IDE включает визуальный редактор для Quarto markdown, включая поддержку таблиц, цитат, перекрестных ссылок, сносок, разделов / промежутков, списков определений, атрибутов, необработанного HTML / TeX и многого другого:</p>
</section>
</section>
<section id="движок-knitr" class="level3">
<h3 class="anchored" data-anchor-id="движок-knitr"><strong>1.3 Движок Knitr</strong></h3>
<p>Вот некоторые основные комментарии, используемые в KNITR:</p>
<ol type="1">
<li><p><strong>Chunk Options</strong>: Комментарии для управления настройками кодовых ячеек. Например:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Для отключения вывода кода</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Установка заголовка для графика</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig.cap: "График 1"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></li>
<li><p><strong>Chunk Labels</strong>: Можно назначать уникальные метки кодовым ячейкам:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Назначение метки для кодовой ячейки</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="co">#| {#my-label}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></li>
<li><p><strong>Глобальные Опции</strong>: Комментарии, которые применяются к всем кодовым ячейкам: <code># Установка глобальных опций для отображения результатов с округлением     opts_chunk$set(echo = TRUE, warning = FALSE, message = FALSE, tidy = TRUE)</code></p></li>
<li><p><strong>Вставка Графики</strong>: Для вставки графики в документ:</p>
<p><img src="Myplot.png" class="img-fluid" width="351" alt="My plot">{Width = 50%}</p></li>
</ol>
<p>Как правило, вы должны иметь возможность использовать Quarto для рендеринга любого существующего документа Rmd без изменений. Одно из важных различий между документами R Markdown и документами Quarto заключается в том, что в Quarto параметры фрагмента обычно включаются в специальные комментарии в верхней части фрагментов кода, а не в строке, с которой начинается фрагмент. Например:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(airquality, <span class="fu">aes</span>(Temp, Ozone)) <span class="sc">+</span> </span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">'darkgreen'</span>) <span class="sc">+</span> </span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">color=</span> <span class="st">'darkorange'</span>, <span class="at">method =</span> <span class="st">"loess"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Quarto_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption class="figure-caption">Air Quality</figcaption>
</figure>
</div>
</div>
</div>
<p>Quarto использует этот подход как для лучшего размещения более длинных опций, таких как <strong>fig-cap, fig-subcap и fig-alt</strong>, так и для упрощения редактирования параметров фрагмента в более структурированных редакторах, в которых нет простого способа редактировать метаданные фрагмента (например, большинство традиционных пользовательских интерфейсов ноутбуков).</p>
</section>
<section id="движок-jupyter" class="level3">
<h3 class="anchored" data-anchor-id="движок-jupyter"><strong>1.4 Движок Jupyter</strong></h3>
<p>Вы также можете работать с документами Quarto markdown, предназначенными для движка Jupyter в RStudio. Эти файлы обычно включают <code>jupyter</code> параметр во интерфейсе YAML, указывающий, какое ядро использовать. Например:</p>
<p>Если вы хотите работать в виртуальной среде (<a href="https://packaging.python.org/guides/installing-using-pip-and-virtual-environments/#creating-a-virtual-environment">venv</a>), используйте команду <strong>File :</strong> <strong>New Project...</strong>, укажите движок<strong>Jupyter</strong>.с помощью venv и укажите, какими пакетами вы хотели бы заполнить venv:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Jupiter.png" class="img-fluid figure-img" width="315"></p>
<figcaption class="figure-caption">Jupyter</figcaption>
</figure>
</div>
<p>RStudio автоматически активирует эту виртуальную среду всякий раз, когда вы открываете проект.&nbsp;Вы можете установить дополнительные пакеты Python в среду, используя вкладку RStudio “<strong>Терминал</strong>”.</p>
<p><strong>Сочетания клавиш</strong></p>
<p>Для всех основных задач редактирования есть сочетания клавиш. Визуальный режим поддерживает как традиционные сочетания клавиш (например, ⌃ B для выделения жирным шрифтом), так и сочетания markdown (напрямую используя синтаксис markdown). Например, заключите <strong>bold</strong> текст в звездочки или введите ## и нажмите пробел, чтобы создать заголовок второго уровня. Вот некоторые из наиболее часто используемых сочетаний клавиш:</p>
<table class="table">
<thead>
<tr class="header">
<th>Команда</th>
<th style="text-align: center;">Сочетание клавиш</th>
<th style="text-align: center;">Ярлык Markdown</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Выделено жирным шрифтом</td>
<td style="text-align: center;">⌃ B</td>
<td style="text-align: center;"><code>**bold**</code></td>
</tr>
<tr class="even">
<td>Курсив</td>
<td style="text-align: center;">⌃ I</td>
<td style="text-align: center;"><code>*italic*</code></td>
</tr>
<tr class="odd">
<td>Код</td>
<td style="text-align: center;">⌃ D</td>
<td style="text-align: center;"><code>`code`</code></td>
</tr>
<tr class="even">
<td>Заголовок 1</td>
<td style="text-align: center;">⌥⌃ 1</td>
<td style="text-align: center;"><code>#</code></td>
</tr>
<tr class="odd">
<td>Заголовок 2</td>
<td style="text-align: center;">⌥⌃ 2</td>
<td style="text-align: center;"><code>##</code></td>
</tr>
<tr class="even">
<td>Заголовок 3</td>
<td style="text-align: center;">⌥⌃ 3</td>
<td style="text-align: center;"><code>###</code></td>
</tr>
<tr class="odd">
<td>Ссылка</td>
<td style="text-align: center;">⌃ K</td>
<td style="text-align: center;"><code>&lt;href&gt;</code></td>
</tr>
<tr class="even">
<td>Фрагмент кода R</td>
<td style="text-align: center;">⌥⌃ I</td>
<td style="text-align: center;"><code>```{r}</code></td>
</tr>
</tbody>
</table>
<p><strong>Вставьте что-нибудь</strong></p>
<p>Вы также можете использовать универсальный ⌃ / ярлык для вставки практически всего. Просто запустите ярлык, а затем введите то, что вы хотите вставить. Например:</p>
<p>Если вы находитесь в начале строки (как показано выше), вы также можете ввести обычный /, чтобы вызвать ярлык.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="paste.png" class="img-fluid figure-img" width="339"></p>
<figcaption class="figure-caption">paste</figcaption>
</figure>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="math.png" class="img-fluid figure-img" width="335"></p>
<figcaption class="figure-caption">math</figcaption>
</figure>
</div>
<hr>
</section>
<section id="техническое-письмо" class="level3">
<h3 class="anchored" data-anchor-id="техническое-письмо"><strong>1.5 Техническое письмо</strong></h3>
<p>Визуальный режим включает в себя обширную поддержку функций QUARTO, часто используемых в техническом написании, включая <a href="https://quarto.org/docs/visual-editor/technical.html#equations">уравнения</a>, <a href="https://quarto.org/docs/visual-editor/technical.html#citations">цитаты</a>, <a href="https://quarto.org/docs/visual-editor/technical.html#cross-references">перекрестные ссылки</a>, <a href="https://quarto.org/docs/visual-editor/technical.html#footnotes">сноски</a>, <a href="https://quarto.org/docs/visual-editor/technical.html#embedded-code">встроенный код</a> и <a href="https://quarto.org/docs/visual-editor/technical.html#latex-and-html">LaTeX</a>. В этой статье более подробно описывается использование этих функций.</p>
<section id="уравнения-синтаксис-pandoc-markdown" class="level4">
<h4 class="anchored" data-anchor-id="уравнения-синтаксис-pandoc-markdown"><strong>1.5.1 Уравнения (</strong>синтаксис Pandoc markdown )</h4>
<p>Уравнения LaTeX создаются с использованием стандартного синтаксиса Pandoc markdown (редактор автоматически распознает синтаксис и обрабатывает уравнение как математическое). Если вы не редактируете уравнение напрямую, оно будет отображаться как визуализированное математическое:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="editing-math.png" class="img-fluid figure-img" width="476"></p>
<figcaption class="figure-caption">edit formula</figcaption>
</figure>
</div>
<p>Как показано выше, когда вы выбираете уравнение с помощью клавиатуры или мыши, вы можете отредактировать LaTeX уравнения.&nbsp;Предварительный просмотр уравнения будет показан под ним по мере ввода.</p>
<ol type="1">
<li><p><strong>Символы и функции LaTeX</strong>:</p>
<ul>
<li><p>Для математических символов, индексов и специальных функций LaTeX, вы можете использовать обратный слеш <strong><code>\</code></strong> перед их именами. Например, <strong><code>\alpha</code></strong>, <strong><code>\sum</code></strong>, <strong><code>\int</code></strong>, и так далее.</p></li>
<li><p>Для нижних индексов используйте символ нижнего подчеркивания: <strong><code>a_{1}</code></strong>, а для верхних индексов - символ верхнего подчеркивания: <strong><code>x^{2}</code></strong>.</p></li>
</ul></li>
<li><p><strong>Дроби и корни</strong>:</p>
<ul>
<li><p>Для создания дробей используйте <strong><code>\frac{числитель}{знаменатель}</code></strong>: <strong><code>\frac{a}{b}</code></strong>.</p></li>
<li><p>Для корней используйте <strong><code>\sqrt{выражение}</code></strong>: <strong><code>\sqrt{2}</code></strong>.</p></li>
</ul></li>
<li><p><strong>Греческие буквы</strong>:</p>
<ul>
<li>Для вставки греческих букв, используйте соответствующие команды LaTeX, например, <strong><code>\alpha</code></strong>, <strong><code>\beta</code></strong>, <strong><code>\gamma</code></strong>.</li>
</ul></li>
<li><p><strong>Символы математической нотации</strong>:</p>
<ul>
<li>Множество математических символов и операторов, таких как сумма, интеграл, логарифм и другие, также могут быть вставлены с использованием их LaTeX-команд.</li>
</ul></li>
</ol>
<p>Примеры синтаксиса для разных типов уравнений:</p>
<p>Это встроенное уравнение: <span class="math inline">\(E=mc^2\)</span></p>
<p>Это уравнение с номером:</p>
<p><span class="math display">\[
F=ma
\]</span></p>
<p>И еще одно:<span class="math display">\[\begin{equation}
a^2 + b^2 = c^2
\end{equation}\]</span> ``` Дроби и корни: <span class="math inline">\(\frac{1}{2}\)</span>, <span class="math inline">\(\sqrt{x}\)</span></p>
<p>Греческие буквы: <span class="math inline">\(\alpha\)</span>, <span class="math inline">\(\beta\)</span>, <span class="math inline">\(\gamma\)</span></p>
<p>Математические символы: <span class="math inline">\(\sum_{i=1}^{n} x_i\)</span>, <span class="math inline">\(\int_{0}^{1} f(x) dx\)</span></p>
<hr>
</section>
<section id="перекрестные-ссылки" class="level4">
<h4 class="anchored" data-anchor-id="перекрестные-ссылки"><strong>1.5.2 Перекрестные ссылки</strong></h4>
<p><a href="https://quarto.org/docs/authoring/cross-references.html">Перекрестные ссылки</a> облегчают читателям навигацию по вашему документу, предоставляя пронумерованные ссылки и гиперссылки на различные объекты, такие как рисунки, таблицы и уравнения.</p>
<p>Для каждого объекта с перекрестными ссылками требуется метка (уникальный идентификатор) и подпись (описание). Например, это рисунок с перекрестными ссылками:</p>
<div id="fig-elephant" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="big-elephant.png" class="img-fluid figure-img" width="376"></p>
<figcaption class="figure-caption">Figure&nbsp;1: Elephant</figcaption>
</figure>
</div>
<p>Наличие подписи (“Elephant”) и надписи (<code>#fig-elephant</code>) делает этот рисунок доступным для ссылок.&nbsp;Это позволяет использовать следующий синтаксис для ссылки на него в другом месте документа:</p>
<p>See <a href="#fig-elephant">Figure&nbsp;1</a> for an illustration.</p>
<p>Используйте&nbsp;<strong>команду Вставить -&gt; Перекрестная ссылка ...</strong>&nbsp;чтобы вставить перекрестную ссылку:</p>
<p>Вы также можете просто ввести префикс метки перекрестной ссылки (например,&nbsp;<code>@fig-env</code>) и выбрать его с помощью автозаполнения:</p>
</section>
<section id="сноски" class="level4">
<h4 class="anchored" data-anchor-id="сноски"><strong>1.5.3 Сноски</strong></h4>
<p>Вы можете добавлять сноски с помощью команды <strong>Вставить -&gt; Сноска</strong> (или ⇧⌃ F7 сочетания клавиш). Редактирование сносок происходит на панели непосредственно под основным документом:</p>
<hr>
<hr>
</section>
<section id="встроенный-код" class="level4">
<h4 class="anchored" data-anchor-id="встроенный-код"><strong>1.5.4 Встроенный код</strong></h4>
<p>Исходный код, который вы включаете в документ Кварто, может быть либо предназначен только для отображения, либо может быть выполнен Jupyter или Knitr как часть рендеринга. Код, кроме того, может быть встроенным или блочным.</p>
<section id="отображение-кода" class="level5">
<h5 class="anchored" data-anchor-id="отображение-кода"><strong>1.5.4.1 Отображение кода</strong></h5>
<p>Чтобы отобразить, но не выполнить код, либо воспользуйтесь пунктом меню <strong>Вставка -&gt; Блок кода</strong>, либо начните новую строку и введите либо:</p>
<ol type="1">
<li><code>```</code> (для простого блока кода);</li>
</ol>
<pre><code>x &lt;- c(2:10,2)
sum(x)</code></pre>
<ol start="2" type="1">
<li><code>```&lt;lang&gt;</code> (где &lt;lang&gt; - язык) для блока кода с подсветкой синтаксиса.</li>
</ol>
<div class="sourceCode" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">10</span>,<span class="dv">2</span>)</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Затем нажмите клавишу <strong>Enter</strong>. Чтобы отобразить код в строке, просто окружите текст обратными метками (<code>`code`</code>) или воспользуйтесь пунктом меню <strong>Формат -&gt; Код</strong>.</p>
<ol start="3" type="1">
<li><p>Код в строке: ` `</p>
<p>это код <code>x = c(2:10)</code> написан в строке</p></li>
</ol>
</section>
<section id="фрагменты-кода" class="level5">
<h5 class="anchored" data-anchor-id="фрагменты-кода"><strong>1.5.4.2 Фрагменты кода</strong></h5>
<p>Чтобы вставить фрагмент исполняемого кода, используйте пункт меню <strong>Вставка -&gt; Фрагмент кода</strong> или начните новую строку и введите:</p>
<p><code>```{r}</code></p>
<p>Затем нажмите клавишу <strong>Enter</strong>. Обратите внимание, что <code>r</code> knitr может поддерживать другой язык (например, <code>python</code> или <code>sql</code>), и вы также можете включить метку фрагмента и другие параметры фрагмента.</p>
<p>Чтобы включить встроенный R-код, вы просто создаете обычный встроенный код (например, используя обратные ссылки или ⌃ D ярлык), но предваряете его <code>r</code>. Например, этот встроенный код будет выполняться knitr: <code>2023-10-05</code>. Обратите внимание, что когда код отображается в визуальном режиме, у него не будет обратных меток (но они все равно будут отображаться в исходном режиме).</p>
</section>
<section id="выполняемые-фрагменты" class="level5">
<h5 class="anchored" data-anchor-id="выполняемые-фрагменты"><strong>1.5.4.3 Выполняемые фрагменты</strong></h5>
<p>Выбранный в данный момент фрагмент кода на R или Python можно выполнить либо с помощью кнопки выполнить в правом верхнем углу фрагмента кода, либо с помощью ⇧⌃ Enter сочетания клавиш:</p>
<hr>
</section>
</section>
<section id="цитаты" class="level4">
<h4 class="anchored" data-anchor-id="цитаты"><strong>1.5.5 Цитаты</strong></h4>
<hr>
<p>Визуальный режим использует стандартное представление Pandoc markdown для цитирования (например, <code>[@citation]</code>). Цитаты могут быть вставлены из различных источников:</p>
<ol type="1">
<li><p>Библиография вашего документа.</p></li>
<li><p><a href="https://quarto.org/docs/visual-editor/technical.html#citations-from-zotero">Личные или групповые библиотекиZotero</a>.</p></li>
<li><p><a href="https://quarto.org/docs/visual-editor/technical.html#citations-from-dois">DOI</a> (идентификатор объекта документа) ссылки.</p></li>
<li><p>Поиск по <a href="https://www.crossref.org/">перекрестным ссылкам</a>, <a href="https://datacite.org/">DataCite</a> или <a href="https://pubmed.ncbi.nlm.nih.gov/">PubMed</a>.</p></li>
</ol>
<p>Если вы вставляете цитаты из Zotero, DOI look-up или поиска, они автоматически добавляются в библиографию вашего документа.</p>
</section>
<section id="библиографии" class="level4">
<h4 class="anchored" data-anchor-id="библиографии"><strong>1.5.6 Библиографии</strong></h4>
<p>Pandoc поддерживает библиографии в широком разнообразии форматов, включая BibTeX и CSL. Добавьте библиографию в свой документ, используя <code>bibliography</code> поле метаданных YAML. Например:</p>
<p>Обратите внимание, что мы также указали link-citations опцию, которая сделает ваши цитаты гиперссылками на соответствующие библиографические записи.</p>
<p>Дополнительную информацию о форматах библиографии см. в документации Pandoc Citations.</p>
<p>Вставка цитат Вы вставляете цитаты либо с помощью команды Вставить -&gt; Цитирование, либо напрямую используя синтаксис markdown (например, <span class="citation" data-cites="cite">[@cite]</span> или <span class="citation" data-cites="cite">@cite</span>) .</p>
<p>Цитаты заключаются в квадратные скобки и разделяются точкой с запятой. Каждая цитата должна иметь ключ, состоящий из ‘@’ + идентификатор цитаты из базы данных, и необязательно может иметь префикс, указатель и суффикс. Клавиша цитирования должна начинаться с буквы, цифры или _ и может содержать буквенно-цифровые обозначения _ и внутренние знаки препинания (:.#$%&amp;-+?&lt;&gt;~/). Вот несколько примеров:</p>
<p>Бла-бла-бла <span class="citation" data-cites="doe99 smith04">[см. @doe99, стр. 33-35; также @smith04, глава. 1]</span>.</p>
<p>Бла-бла-бла <span class="citation" data-cites="doe99">[@doe99, стр. 33-35, 38-39 и passim]</span>.</p>
<p>Бла-бла-бла <span class="citation" data-cites="smith04 doe99">[@smith04; @doe99]</span>.</p>
<p>Смит говорит чушь <span class="citation" data-cites="smith04">[-@smith04]</span>.</p>
<p>Вы также можете использовать цитаты в тексте следующим образом:</p>
<p><span class="citation" data-cites="smith04">@smith04</span> говорит чушь.</p>
<p><span class="citation" data-cites="smith04стр">[@smith04стр. 33]</span> говорит чушь.</p>
</section>
<section id="синтаксис-markdown" class="level4">
<h4 class="anchored" data-anchor-id="синтаксис-markdown">1.5.7 Синтаксис Markdown</h4>
<p>Вы также можете вставлять цитаты напрямую, используя синтаксис markdown (например, <code>[@cite]</code>). Когда вы делаете это, предоставляется интерфейс завершения для поиска доступных ссылок:</p>
</section>
</section>
</section>
<section id="quarto-r4ds-part_29" class="level2">
<h2 class="anchored" data-anchor-id="quarto-r4ds-part_29">2. QUARTO (R4DS: part_29)</h2>
<section id="введение" class="level3">
<h3 class="anchored" data-anchor-id="введение"><strong>2.1 Введение</strong></h3>
<p>Quarto предоставляет унифицированную платформу разработки для науки о данных, объединяющую ваш код, его результаты и вашу прозу. Документы формата кварто полностью воспроизводимы и поддерживают десятки выходных форматов, таких как PDF-файлы, файлы Word, презентации и другие.</p>
<p>Файлы формата кварто предназначены для использования тремя способами:</p>
<ol type="1">
<li><p>Для общения с лицами, принимающими решения, которые хотят сосредоточиться на выводах, а не на коде, лежащем в основе анализа.</p></li>
<li><p>За сотрудничество с другими специалистами по обработке данных (включая future you!), которым интересны как ваши выводы, так и то, как вы к ним пришли (т.е. код).</p></li>
<li><p>Как среда для <em>занятий</em> data science, как современный лабораторный блокнот, в котором вы можете записывать не только то, что вы сделали, но и то, о чем вы думали.</p></li>
</ol>
<p>Quarto - это инструмент интерфейса командной строки, а не пакет R. Это означает, что справка, по большому счету, недоступна через <code>?</code>. Вместо этого, при работе с этой главой и использовании кварто в будущем, вам следует обратиться к <a href="https://quarto.org/">документации по Кварто</a>.</p>
<p>Если вы являетесь пользователем R Markdown, вы можете подумать: “Кварто звучит очень похоже на R Markdown”. Вы не ошибаетесь! Quarto объединяет функциональность многих пакетов из экосистемы R Markdown (rmarkdown, bookdown, distill, xaringan и т.д.) в единую согласованную систему, а также расширяет ее встроенной поддержкой нескольких языков программирования, таких как Python и Julia, в дополнение к R. В некотором смысле, Quarto отражает все, что было извлечено из расширения и поддержки экосистемы R Markdown за десятилетие.</p>
<section id="предварительные-требования" class="level4">
<h4 class="anchored" data-anchor-id="предварительные-требования"><strong>2.1.1 Предварительные требования</strong></h4>
<p>Вам нужен интерфейс командной строки Кварто (Quarto CLI), но вам не нужно явно устанавливать его или загружать, поскольку RStudio автоматически выполняет и то, и другое при необходимости.</p>
</section>
</section>
<section id="основы-кварто" class="level3">
<h3 class="anchored" data-anchor-id="основы-кварто"><strong>2.2 Основы Кварто</strong></h3>
<p>Это файл Кварто – обычный текстовый файл, имеющий расширение <code>.qmd</code>:</p>
<p>Он содержит три важных типа контента:</p>
<ol type="1">
<li><p>(Необязательно) <strong>Заголовок YAML,</strong> окруженный <code>---</code>буквами s.</p></li>
<li><p><strong>Фрагменты</strong> R-кода, окруженные <code>```</code>.</p></li>
<li><p>Текст, смешанный с простым форматированием текста, таким как <code># heading</code> и <code>_italics_</code>.</p></li>
</ol>
<p>Чтобы создать полный отчет, содержащий весь текст, код и результаты, нажмите “Визуализация” или нажмите Cmd / Ctrl + Shift + K.&nbsp;Вы также можете сделать это программно с помощью&nbsp;<code>quarto::quarto_render("diamond-sizes.qmd")</code>.&nbsp;При этом отчет отобразится на панели просмотра, как показано на&nbsp;<a href="https://r4ds.hadley.nz/quarto#fig-diamond-sizes-report">рисунке&nbsp;29.3</a>, и будет создан HTML-файл.</p>
<p>При визуализации документа Quarto отправляет&nbsp;<code>.qmd</code>&nbsp;файл в&nbsp;<strong>knitr</strong>,&nbsp;<a href="https://yihui.org/knitr/">https://yihui.org/knitr /</a>, который выполняет все фрагменты кода и создает новый документ markdown (<code>.md</code>), который включает код и его выходные данные.&nbsp;Файл markdown, созданный knitr, затем обрабатывается&nbsp;<strong>pandoc</strong>,&nbsp;<a href="https://pandoc.org/">https://pandoc.org</a>&nbsp;который отвечает за создание готового файла.&nbsp;Этот процесс показан на рис 1.&nbsp;Преимущество этого двухэтапного рабочего процесса заключается в том, что вы можете создавать очень широкий диапазон выходных форматов, о чем вы узнаете в&nbsp;<a href="https://r4ds.hadley.nz/quarto-formats">главе 30</a>.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="quarto-flow.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Схема рабочего процесса Кварто из qmd в knitr, md, pandoc для вывода в форматах PDF, MS Word или HTML.</figcaption>
</figure>
</div>
</section>
<section id="визуальный-редактор" class="level3">
<h3 class="anchored" data-anchor-id="визуальный-редактор"><strong>2.3 Визуальный редактор</strong></h3>
<p>Визуальный редактор в RStudio предоставляет <a href="https://en.wikipedia.org/wiki/WYSIWYM">интерфейс WYSIWYM</a> для создания документов формата Quarto. Под капотом документы prose in Quarto (<code>.qmd</code> файлы) написаны на Markdown, облегченном наборе соглашений для форматирования обычных текстовых файлов. Фактически, Quarto использует Pandoc markdown (слегка расширенную версию Markdown, понятную Quarto), включая таблицы, цитаты, перекрестные ссылки, сноски, divs / spans, списки определений, атрибуты, необработанный HTML / TeX и многое другое, а также поддержку выполнения ячеек кода и просмотра их выходных данных в строке. Хотя Markdown разработан таким образом, чтобы его было легко читать и записывать, как вы увидите в <a href="https://r4ds.hadley.nz/quarto#sec-source-editor">разделе 29.4</a>, он по-прежнему требует изучения нового синтаксиса. Поэтому, если вы новичок в работе с вычислительными документами, такими как <code>.qmd</code> files, но имеете опыт использования таких инструментов, как Google Docs или MS Word, самый простой способ начать работу с Quarto в RStudio - это визуальный редактор.</p>
<p>В визуальном редакторе вы можете либо использовать кнопки в строке меню для вставки изображений, таблиц, перекрестных ссылок и т.д., либо вы можете использовать универсальный ⌘ / ярлык для вставки практически всего. Если вы находитесь в начале строки (как показано на <a href="https://r4ds.hadley.nz/quarto#fig-visual-editor">рисунке 29.5</a>), вы также можете ввести просто/, чтобы вызвать ярлык.</p>
</section>
<section id="редактор-исходных-текстов" class="level3">
<h3 class="anchored" data-anchor-id="редактор-исходных-текстов"><strong>2.4 Редактор исходных текстов</strong></h3>
<p>Вы также можете редактировать документы Quarto с помощью редактора исходных текстов в RStudio без помощи визуального редактора. В то время как визуальный редактор покажется знакомым тем, у кого есть опыт работы с такими инструментами, как Google docs, редактор исходного кода покажется знакомым тем, у кого есть опыт написания R-скриптов или документов R Markdown. Редактор исходного кода также может быть полезен для отладки любых синтаксических ошибок кварто, поскольку часто их легче обнаружить в обычном тексте.</p>
<p>В приведенном ниже руководстве показано, как использовать Pandoc’s Markdown для создания документов формата Quarto в редакторе исходных текстов.</p>
<pre><code>## Text formatting

*italic* **bold** ~~strikeout~~ `code`

superscript^2^ subscript~2~

[underline]{.underline} [small caps]{.smallcaps}

## Headings

# 1st Level Header

## 2nd Level Header

### 3rd Level Header

## Lists

-   Bulleted list item 1

-   Item 2

    -   Item 2a

    -   Item 2b

1.  Numbered list item 1

2.  Item 2. The numbers are incremented automatically in the output.

## Links and images

\&lt;http://example.com&gt;

[linked phrase](http://example.com)

![optional caption text](quarto.png){fig-alt="Quarto logo and the word quarto spelled in small case letters"}

## Tables

| First Header | Second Header |
|--------------|---------------|
| Content Cell | Content Cell  |
| Content Cell | Content Cell  |</code></pre>
<p>Лучший способ изучить их - просто попробовать.&nbsp;Это займет несколько дней, но вскоре они станут второй натурой, и вам не нужно будет думать о них.&nbsp;Если вы забыли, вы можете получить доступ к удобному справочному листу с помощью&nbsp;<em>Справки &gt; Краткий справочник Markdown</em>.</p>
<p>2.5.1 Метка фрагмента Фрагментам можно присвоить необязательную метку, например</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span> <span class="sc">+</span> <span class="dv">1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2</code></pre>
</div>
</div>
<p>Это имеет три преимущества:</p>
<ol type="1">
<li><p>Вы можете более легко переходить к конкретным фрагментам, используя раскрывающийся навигатор кода в левом нижнем углу редактора сценариев:</p></li>
<li><p>Графические изображения, создаваемые фрагментами, будут иметь полезные названия, которые облегчат их использование в других местах. Подробнее об этом в <a href="https://r4ds.hadley.nz/quarto#sec-figures">разделе 29.6</a>.</p></li>
<li><p>Вы можете настроить сети кэшированных блоков, чтобы избежать повторного выполнения дорогостоящих вычислений при каждом запуске. Подробнее об этом в <a href="https://r4ds.hadley.nz/quarto#sec-caching">разделе 29.8</a>.</p></li>
</ol>
<p>Ваши метки блоков должны быть короткими, но запоминающимися и не должны содержать пробелов. Мы рекомендуем использовать тире (<code>-</code>) для разделения слов (вместо подчеркивания, <code>_</code>) и избегать других специальных символов в метках блоков.</p>
<p>Обычно вы вольны обозначать свой блок как вам нравится, но есть одно название блока, которое придает ему особое поведение: <code>setup</code>. Когда вы находитесь в режиме записной книжки, блок с именем setup будет запущен автоматически один раз, перед запуском любого другого кода.</p>
<p>Кроме того, метки блоков нельзя дублировать. Каждая метка блока должна быть уникальной.</p>
<section id="параметры-фрагмента" class="level4">
<h4 class="anchored" data-anchor-id="параметры-фрагмента"><strong>2.5.2 Параметры фрагмента</strong></h4>
<p>Вывод фрагмента можно настроить с помощью <strong>опций</strong>, полей, предоставляемых в заголовке фрагмента. Knitr предоставляет почти 60 параметров, которые вы можете использовать для настройки своих фрагментов кода. Здесь мы рассмотрим наиболее важные параметры фрагмента, которые вы будете часто использовать. Вы можете ознакомиться с полным списком по адресу <a href="https://yihui.org/knitr/options/">https://yihui.org/knitr/options</a>.</p>
<p>Наиболее важный набор параметров определяет, выполняется ли ваш блок кода и какие результаты вставляются в готовый отчет:</p>
<ul>
<li><p><code>eval: false</code> предотвращает вычисление кода. (И очевидно, что если код не выполняется, никаких результатов сгенерировано не будет). Это полезно для отображения примера кода или для отключения большого блока кода без комментирования каждой строки.</p></li>
<li><p><code>include: false</code> запускает код, но не отображает код или результаты в итоговом документе. Используйте это для кода настройки, который не должен загромождать ваш отчет.</p></li>
<li><p><code>echo: false</code> предотвращает отображение кода, но не результатов в готовом файле. Используйте это при написании отчетов, предназначенных для людей, которые не хотят видеть базовый R-код.</p></li>
<li><p><code>message: false</code> или <code>warning: false</code> предотвращает появление сообщений или предупреждений в готовом файле.</p></li>
<li><p><code>results: hide</code> скрывает печатный вывод; <code>fig-show: hide</code> скрывает графики.</p></li>
<li><p><code>error: true</code> заставляет рендеринг продолжаться, даже если код возвращает ошибку. Это редко то, что вы захотите включить в окончательную версию своего отчета, но может быть очень полезно, если вам нужно точно отладить то, что происходит внутри вашего <code>.qmd</code>. Это также полезно, если вы обучаете R и хотите намеренно включить ошибку. Значение по умолчанию <code>error: false</code> приводит к сбою рендеринга, если в документе есть одна ошибка.</p></li>
</ul>
<p>Каждый из этих параметров блока добавляется в заголовок блока, следующего за <code>#|</code>, например, в следующем блоке результат не печатается, поскольку <code>eval</code> установлено значение false.</p>
<pre><code>#| label: simple-multiplication
#| eval: false

2 * 2</code></pre>
<p>В следующей таблице приведены сведения о том, какие типы выходных данных подавляет каждая опция:</p>
<table class="table">
<colgroup>
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 14%">
</colgroup>
<thead>
<tr class="header">
<th>Вариант</th>
<th style="text-align: center;">Запустить код</th>
<th style="text-align: center;">Показать код</th>
<th style="text-align: center;">Результат</th>
<th style="text-align: center;">Графики</th>
<th style="text-align: center;">Сообщения</th>
<th style="text-align: center;">Предупреждения</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>eval: false</code></td>
<td style="text-align: center;">X</td>
<td style="text-align: center;"></td>
<td style="text-align: center;">X</td>
<td style="text-align: center;">X</td>
<td style="text-align: center;">X</td>
<td style="text-align: center;">X</td>
</tr>
<tr class="even">
<td><code>include: false</code></td>
<td style="text-align: center;"></td>
<td style="text-align: center;">X</td>
<td style="text-align: center;">X</td>
<td style="text-align: center;">X</td>
<td style="text-align: center;">X</td>
<td style="text-align: center;">X</td>
</tr>
<tr class="odd">
<td><code>echo: false</code></td>
<td style="text-align: center;"></td>
<td style="text-align: center;">X</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
<tr class="even">
<td><code>results: hide</code></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;">X</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
<tr class="odd">
<td><code>fig-show: hide</code></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;">X</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
<tr class="even">
<td><code>message: false</code></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;">X</td>
<td style="text-align: center;"></td>
</tr>
<tr class="odd">
<td><code>warning: false</code></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;">X</td>
</tr>
</tbody>
</table>
</section>
<section id="глобальные-параметры" class="level4">
<h4 class="anchored" data-anchor-id="глобальные-параметры"><strong>2.5.3 Глобальные параметры</strong></h4>
<p>По мере того, как вы будете больше работать с knitr, вы обнаружите, что некоторые параметры блоков по умолчанию не соответствуют вашим потребностям, и вы захотите их изменить.</p>
<p>Вы можете сделать это, добавив предпочтительные параметры в документ YAML в разделе <code>execute</code>. Например, если вы готовите отчет для аудитории, которой не нужно видеть ваш код, а только ваши результаты и описание, вы можете установить <code>echo: false</code> на уровне документа. Это скроет код по умолчанию, поэтому будут показаны только те фрагменты, которые вы намеренно выбрали для отображения (с <code>echo: true</code>). Вы могли бы рассмотреть возможность установки <code>message: false</code> и <code>warning: false</code>, но это усложнило бы отладку проблем, поскольку вы не увидели бы никаких сообщений в окончательном документе.</p>
<pre><code>title: "My report" execute:   echo: false</code></pre>
<p>Поскольку Quarto разработан как многоязычный (работает как с R, так и с другими языками, такими как Python, Julia и т.д.), все опции knitr недоступны на уровне выполнения документа, поскольку некоторые из них работают только с knitr, а не с другими движками, которые Quarto использует для запуска кода на других языках (например, Jupyter). Однако вы все равно можете задать их в качестве глобальных параметров для своего документа в <code>knitr</code> поле под <code>opts_chunk</code>. Например, при написании книг и руководств мы устанавливаем:</p>
<pre><code>title: "Tutorial" knitr:   opts_chunk:     comment: "#&gt;"     collapse: true</code></pre>
<p>При этом используется наше предпочтительное форматирование комментариев и гарантируется, что код и выходные данные будут тесно переплетены.</p>
</section>
<section id="встроенный-код-1" class="level4">
<h4 class="anchored" data-anchor-id="встроенный-код-1"><strong>2.5.4 встроенный код</strong></h4>
<p>Есть еще один способ встроить код R в документ Quarto: непосредственно в текст с помощью: <code>`r `</code>. Это может быть очень полезно, если вы упомянете свойства ваших данных в тексте. Например, пример документа, использованного в начале главы, содержал:</p>
<p>У нас есть данные об <code>53940</code> алмазах. Только ``</p>
<p>При визуализации отчета результаты этих вычислений вставляются в текст:</p>
<p>У нас есть данные о 53940 бриллиантах. Только 126 из них имеют вес более 2,5 карата. Распределение остатка показано ниже:</p>
<p>При вставке цифр в текст <a href="https://rdrr.io/r/base/format.html"><code>format()</code></a> является вашим другом. Это позволяет вам устанавливать количество<code>digits</code>, чтобы вы не печатали с нелепой степенью точности, и <code>big.mark</code> чтобы цифры было легче читать. Вы могли бы объединить их в вспомогательную функцию:</p>
<pre><code>comma &lt;- function(x) format(x, digits = 2, big.mark = ",") 
comma(3452345) 
#&gt; [1] "3,452,345" 
comma(.12358124331) 
#&gt; [1] "0.12"</code></pre>
<p>Рисунки в документе Кварто могут быть встроены (например, в файл PNG или JPEG) или сгенерированы в результате фрагмента кода.</p>
<p>Чтобы внедрить изображение из внешнего файла, вы можете воспользоваться меню Вставка в визуальном редакторе в RStudio и выбрать Рисунок / Image. Откроется всплывающее меню, в котором вы можете перейти к изображению, которое хотите вставить, а также добавить к нему альтернативный текст или подпись и настроить его размер. В визуальном редакторе вы также можете просто вставить изображение из буфера обмена в свой документ, и RStudio поместит копию этого изображения в папку вашего проекта.</p>
<p>Если вы включите фрагмент кода, который генерирует цифру (например, включает <code>ggplot()</code> вызов), результирующая цифра будет автоматически включена в ваш документ Quarto.</p>
</section>
</section>
<section id="определение-размера-рисунка" class="level3">
<h3 class="anchored" data-anchor-id="определение-размера-рисунка"><strong>2.6 Определение размера рисунка</strong></h3>
<p>Самая большая проблема графики в Кварто - придать вашим фигурам правильный размер и форму. Существует пять основных параметров, определяющих размер рисунка: <code>fig-width</code>, <code>fig-height</code>, <code>fig-asp</code> <code>out-width</code> и <code>out-height</code>. Определение размера изображения является сложной задачей, поскольку существует два размера (размер рисунка, созданного с помощью R, и размер, в котором он вставляется в выходной документ), а также множество способов указания размера (т. Е. высота, ширина и соотношение сторон: выберите два из трех).</p>
<p>Мы рекомендуем три из пяти вариантов:</p>
<ul>
<li><p>Графики, как правило, выглядят более эстетично, если они имеют одинаковую ширину. Чтобы обеспечить это, установите <code>fig-width: 6</code> (6 дюймов) и <code>fig-asp: 0.618</code> (золотое сечение) по умолчанию. Затем корректируйте только отдельные фрагменты <code>fig-asp</code>.</p></li>
<li><p>Управляйте размером выходных данных с помощью <code>out-width</code> и устанавливайте его равным проценту от ширины основного текста выходного документа. Мы предлагаем <code>out-width: "70%"</code> и <code>fig-align: center</code>.</p>
<p>Это дает графикам возможность дышать, не занимая слишком много места.</p></li>
<li><p>Чтобы поместить несколько участков в один ряд, установите <code>layout-ncol</code> значение 2 для двух участков, 3 для трех участков и т.д. Это эффективно устанавливает <code>out-width</code> значение “50%” для каждого из ваших графиков, если <code>layout-ncol</code> равно 2, “33%”, если <code>layout-ncol</code> равно 3, и т.д. В зависимости от того, что вы пытаетесь проиллюстрировать (например, показать данные или варианты отображения графика), вы также можете внести изменения <code>fig-width</code>, как описано ниже.</p></li>
</ul>
<p>Если вы обнаружите, что вам приходится щуриться, чтобы прочитать текст на вашем графике, вам нужно внести изменения <code>fig-width</code>. Если <code>fig-width</code> больше размера рисунка, отображаемого в окончательном документе, текст будет слишком маленьким; если <code>fig-width</code> меньше, текст будет слишком большим. Часто вам нужно будет провести небольшие эксперименты, чтобы определить правильное соотношение между <code>fig-width</code> и возможной шириной вашего документа. Чтобы проиллюстрировать принцип, следующие три графика имеют <code>fig-width</code> значения 4, 6 и 8 соответственно:</p>
<p><img src="https://r4ds.hadley.nz/quarto_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid">{fig-align=“left” fig-width: 6, fig-asp: 0.618, out-width: “70%”, fig-align: center, layout-ncol }</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://r4ds.hadley.nz/quarto_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Диаграмма рассеяния пробега по шоссе в зависимости от перемещения автомобилей, где точки меньше, чем на предыдущем графике, а текст оси и метки меньше, чем окружающий текст.</figcaption>
</figure>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://r4ds.hadley.nz/quarto_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Диаграмма рассеяния пробега по шоссе в зависимости от перемещения автомобилей, где точки еще меньше, чем на предыдущем графике, а текст оси и метки еще меньше, чем окружающий текст.</figcaption>
</figure>
</div>
<p>Если вы хотите убедиться, что размер шрифта одинаков для всех ваших рисунков, всякий раз, когда вы устанавливаете<code>out-width</code>, вам также нужно будет скорректировать, <code>fig-width</code> чтобы сохранить то же соотношение, что и по умолчанию <code>out-width</code>. Например, если ваше значение по умолчанию <code>fig-width</code> равно 6 и <code>out-width</code> равно “70%”, при настройке <code>out-width: "50%"</code> вам нужно будет установить <code>fig-width</code> значение 4.3 (6 * 0.5 / 0.7).</p>
<p>Определение размера и масштабирование фигур - это искусство и наука, и для того, чтобы все было правильно, может потребоваться итеративный подход методом проб и ошибок. Вы можете узнать больше о размерах фигур в <a href="https://www.tidyverse.org/blog/2020/08/taking-control-of-plot-scaling/">сообщении в блоге “Управление масштабированием графика”</a>.</p>
<section id="другие-важные-параметры" class="level4">
<h4 class="anchored" data-anchor-id="другие-важные-параметры"><strong>2.6.2 Другие важные параметры</strong></h4>
<p>При смешивании кода и текста, как в этой книге, вы можете настроить <code>fig-show: hold</code> так, чтобы графики отображались после кода. Это имеет приятный побочный эффект, заставляя вас разбивать большие блоки кода с их пояснениями.</p>
<p>Чтобы добавить подпись к сюжету, используйте <code>fig-cap</code>. В Quarto это изменит фигуру со встроенной на “плавающую”.</p>
<p>Если вы создаете выходные данные в формате PDF, тип графики по умолчанию - PDF. Это хорошее значение по умолчанию, потому что PDF-файлы представляют собой высококачественную векторную графику. Однако они могут создавать очень большие и медленные графики, если вы отображаете тысячи точек. В этом случае установите <code>fig-format: "png"</code> принудительное использование PNG. Качество их немного ниже, но они будут намного компактнее.</p>
<p>Хорошей идеей будет давать названия фрагментам кода, которые генерируют цифры, даже если вы обычно не помечаете другие фрагменты. Метка фрагмента используется для генерации имени файла графического изображения на диске, поэтому присвоение имен фрагментам значительно упрощает выбор графиков и их повторное использование в других случаях (например, если вы хотите быстро отправить один график в электронное письмо).</p>
</section>
</section>
<section id="таблицы" class="level3">
<h3 class="anchored" data-anchor-id="таблицы">2.7 Таблицы</h3>
<p>Подобно рисункам, в документ кварто можно включить таблицы двух типов. Это могут быть таблицы markdown, которые вы создаете непосредственно в своем документе Quarto (используя меню Вставить таблицу), или они могут быть таблицами, сгенерированными в результате фрагмента кода. В этом разделе мы сосредоточимся на последнем, на таблицах, созданных с помощью вычислений.</p>
<p>По умолчанию Quarto печатает фреймы данных и матрицы такими, какими вы видите их в консоли:</p>
<p>Если вы предпочитаете, чтобы данные отображались с дополнительным форматированием, вы можете использовать&nbsp;<a href="https://rdrr.io/pkg/knitr/man/kable.html"><code>knitr::kable()</code></a>&nbsp;функцию.&nbsp;Приведенный ниже код генерирует&nbsp;<a href="https://r4ds.hadley.nz/quarto#tbl-kable">таблицу&nbsp;29.1</a>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(mtcars[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, ], )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 26%">
<col style="width: 7%">
<col style="width: 5%">
<col style="width: 7%">
<col style="width: 5%">
<col style="width: 7%">
<col style="width: 8%">
<col style="width: 8%">
<col style="width: 4%">
<col style="width: 4%">
<col style="width: 7%">
<col style="width: 7%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">mpg</th>
<th style="text-align: right;">cyl</th>
<th style="text-align: right;">disp</th>
<th style="text-align: right;">hp</th>
<th style="text-align: right;">drat</th>
<th style="text-align: right;">wt</th>
<th style="text-align: right;">qsec</th>
<th style="text-align: right;">vs</th>
<th style="text-align: right;">am</th>
<th style="text-align: right;">gear</th>
<th style="text-align: right;">carb</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Mazda RX4</td>
<td style="text-align: right;">21.0</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">160</td>
<td style="text-align: right;">110</td>
<td style="text-align: right;">3.90</td>
<td style="text-align: right;">2.620</td>
<td style="text-align: right;">16.46</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="even">
<td style="text-align: left;">Mazda RX4 Wag</td>
<td style="text-align: right;">21.0</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">160</td>
<td style="text-align: right;">110</td>
<td style="text-align: right;">3.90</td>
<td style="text-align: right;">2.875</td>
<td style="text-align: right;">17.02</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Datsun 710</td>
<td style="text-align: right;">22.8</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">108</td>
<td style="text-align: right;">93</td>
<td style="text-align: right;">3.85</td>
<td style="text-align: right;">2.320</td>
<td style="text-align: right;">18.61</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">Hornet 4 Drive</td>
<td style="text-align: right;">21.4</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">258</td>
<td style="text-align: right;">110</td>
<td style="text-align: right;">3.08</td>
<td style="text-align: right;">3.215</td>
<td style="text-align: right;">19.44</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Hornet Sportabout</td>
<td style="text-align: right;">18.7</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">360</td>
<td style="text-align: right;">175</td>
<td style="text-align: right;">3.15</td>
<td style="text-align: right;">3.440</td>
<td style="text-align: right;">17.02</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">2</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>mtcars[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, ]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                   mpg cyl disp  hp drat    wt  qsec vs am gear carb
Mazda RX4         21.0   6  160 110 3.90 2.620 16.46  0  1    4    4
Mazda RX4 Wag     21.0   6  160 110 3.90 2.875 17.02  0  1    4    4
Datsun 710        22.8   4  108  93 3.85 2.320 18.61  1  1    4    1
Hornet 4 Drive    21.4   6  258 110 3.08 3.215 19.44  1  0    3    1
Hornet Sportabout 18.7   8  360 175 3.15 3.440 17.02  0  0    3    2</code></pre>
</div>
</div>
</section>
<section id="кэширование" class="level3">
<h3 class="anchored" data-anchor-id="кэширование">2.8 Кэширование</h3>
<p>Обычно каждый рендеринг документа начинается с абсолютно чистого листа. Это отлично подходит для воспроизводимости, поскольку гарантирует, что вы зафиксировали все важные вычисления в коде. Однако это может быть болезненно, если у вас есть некоторые вычисления, которые занимают много времени. Решение <code>cache: true</code>.</p>
<p>Вы можете включить кэш Knitr на уровне документа для кэширования результатов всех вычислений в документе, используя стандартные параметры YAML:</p>
<pre><code>---
title: "My Document"
execute: 
  cache: true
---</code></pre>
<p>Вы также можете включить кэширование на уровне блока для кэширования результатов вычислений в определенном блоке:</p>
<pre><code>#| cache: true

# code for lengthy computation...</code></pre>
<p>Если задано, это сохранит выходные данные фрагмента в файл со специальным именем на диске. При последующих запусках knitr проверит, изменился ли код, и, если этого не произошло, повторно использует кэшированные результаты.</p>
<p>Система кэширования должна использоваться с осторожностью, поскольку по умолчанию она основана только на коде, а не на его зависимостях. Например, здесь processed_data фрагмент зависит от raw-data фрагмента:</p>
<pre><code>#| label: raw-data
#| cache: true

rawdata &lt;- readr::read_csv("a_very_large_file.csv")</code></pre>
<pre><code>#| label: processed_data
#| cache: true

processed_data &lt;- rawdata |&gt; 
  filter(!is.na(import_var)) |&gt; 
  mutate(new_variable = complicated_transformation(x, y, z))</code></pre>
<p>Кэширование processed_data фрагмента означает, что он будет перезапущен при изменении конвейера dplyr, но он не будет перезапущен при изменении read_csv() вызова. Вы можете избежать этой проблемы с помощью <code>dependson</code> опции <code>chank</code> (фрагмент):</p>
<pre><code>#| label: processed-data
#| cache: true
#| dependson: "raw-data"

processed_data &lt;- rawdata |&gt; 
  filter(!is.na(import_var)) |&gt; 
  mutate(new_variable = complicated_transformation(x, y, z))</code></pre>
<p><code>dependson</code> должен содержать символьный вектор для каждого фрагмента, от которого зависит кэшированный фрагмент. Knitr обновит результаты для кэшированного фрагмента всякий раз, когда обнаружит, что одна из его зависимостей изменилась.</p>
<p>Обратите внимание, что фрагменты не будут обновляться в случае <code>a_very_large_file.csv</code> изменений, поскольку кэширование knitr отслеживает изменения только внутри <code>.qmd</code> файла. Если вы хотите также отслеживать изменения в этом файле, вы можете использовать cache.extra опцию. Это произвольное R-выражение, которое делает недействительным кэш при каждом его изменении. Хорошей функцией для использования является <code>file.mtime()</code>: она возвращает данные, когда они были изменены в последний раз. Затем вы можете написать:</p>
<pre><code>#| label: raw-data
#| cache: true
#| cache.extra: !expr file.mtime("a_very_large_file.csv")

rawdata &lt;- readr::read_csv("a_very_large_file.csv")</code></pre>
<p>Мы последовали совету Дэвида Робинсона назвать эти блоки: каждый блок назван в честь основного объекта, который он создает. Это облегчает понимание <code>dependson</code> спецификации.</p>
<p>Поскольку ваши стратегии кэширования становятся все более сложными, рекомендуется регулярно очищать все ваши кэши с помощью <code>knitr::clean_cache()</code>.</p>
</section>
<section id="устранение-неполадок" class="level3">
<h3 class="anchored" data-anchor-id="устранение-неполадок">2.9 Устранение неполадок</h3>
<p>Устранение неполадок в документах Quarto может оказаться сложной задачей, поскольку вы больше не работаете в интерактивной среде R, и вам нужно будет изучить некоторые новые приемы. Кроме того, ошибка могла быть вызвана проблемами с самим документом Кварто или из-за кода R в документе Кварто.</p>
<p>Одной из распространенных ошибок в документах с фрагментами кода являются дублирующиеся метки фрагментов, которые особенно распространены, если ваш рабочий процесс включает копирование и вставку фрагментов кода. Для решения этой проблемы все, что вам нужно сделать, это изменить одну из ваших дублирующихся меток.</p>
<p>Если ошибки вызваны кодом R в документе, первое, что вы всегда должны попробовать, это воссоздать проблему в интерактивном сеансе. Перезапустите R, затем “Запустите все фрагменты” либо из меню Code, либо в разделе Run region, либо с помощью сочетания клавиш Ctrl + Alt + R. Если вам повезет, это воссоздаст проблему, и вы сможете выяснить, что происходит в интерактивном режиме.</p>
<p>Если это не помогает, должно быть что-то другое между вашей интерактивной средой и средой Quarto. Вам нужно будет систематически изучать варианты. Наиболее распространенным отличием является рабочий каталог: рабочий каталог кварто - это каталог, в котором он находится. Проверьте, соответствует ли рабочий каталог вашим ожиданиям, включив <code>getwd()</code> в фрагмент.</p>
<p>Затем проведите мозговой штурм всех факторов, которые могут вызвать ошибку. Вам нужно будет систематически проверять, совпадают ли они в вашем сеансе R и в сеансе Quarto. Самый простой способ сделать это - установить error: true на фрагмент, вызывающий проблему, затем использовать print() и str(), чтобы проверить, соответствуют ли настройки ожидаемым параметрам.</p>
</section>
<section id="заголовок-yaml" class="level3">
<h3 class="anchored" data-anchor-id="заголовок-yaml">2.10 Заголовок YAML</h3>
<p>Вы можете управлять многими другими настройками “всего документа”, изменяя параметры заголовка YAML. Вам может быть интересно, что означает YAML: это “YAML - не язык разметки”, который предназначен для представления иерархических данных способом, удобным для чтения и записи людьми. Quarto использует его для управления многими деталями выходных данных. Здесь мы обсудим три: автономные документы, параметры документа и библиографии.</p>
<section id="автономный" class="level4">
<h4 class="anchored" data-anchor-id="автономный">2.10.1 Автономный</h4>
<p>HTML-документы обычно имеют ряд внешних зависимостей (например, изображения, таблицы стилей CSS, JavaScript и т.д.), И по умолчанию Quarto помещает эти зависимости в _files папку в том же каталоге, что и ваш <code>.qmd</code> файл. Если вы публикуете HTML-файл на хостинговой платформе (например, <code>QuartoPub, https://quartopub.com/</code>), зависимости в этом каталоге публикуются вместе с вашим документом и, следовательно, доступны в опубликованном отчете. Однако, если вы хотите отправить отчет коллеге по электронной почте, возможно, вы предпочтете иметь единый автономный HTML-документ, содержащий все его зависимости. Вы можете сделать это, указав embed-resources параметр:<code>format: html: embed-resources: true</code></p>
<p>Результирующий файл будет автономным, так что для его правильного отображения в браузере не потребуется никаких внешних файлов и доступа в Интернет.</p>
</section>
<section id="параметры" class="level4">
<h4 class="anchored" data-anchor-id="параметры">2.10.2 Параметры</h4>
<p>Документы Кварто могут включать один или несколько параметров, значения которых можно задать при визуализации отчета. Параметры полезны, когда вы хотите повторно отобразить один и тот же отчет с различными значениями для различных ключевых входных данных. Например, вы могли бы создавать отчеты о продажах по филиалам, результаты экзаменов по учащимся или демографические сводки по странам. Чтобы указать один или несколько параметров, используйте <code>params</code> поле.</p>
<p>В этом примере используется my_class параметр для определения, какой класс автомобилей отображать:</p>
</section>
<section id="библиографии-и-цитаты" class="level4">
<h4 class="anchored" data-anchor-id="библиографии-и-цитаты"><strong>2.10.3 Библиографии и цитаты</strong></h4>
<p>Quarto может автоматически генерировать ссылки и библиографию в нескольких стилях. Самый простой способ добавления ссылок и библиографий в документ Quarto - это использование визуального редактора в RStudio.</p>
<p>Чтобы добавить ссылку с помощью визуального редактора, перейдите к Вставка &gt; Цитирование. Ссылки могут быть вставлены из различных источников:</p>
<ol type="1">
<li><p><a href="https://quarto.org/docs/visual-editor/technical.html#citations-from-dois">Ссылки на DOI</a> (идентификатор объекта документа).</p></li>
<li><p><a href="https://quarto.org/docs/visual-editor/technical.html#citations-from-zotero">Личные или групповые библиотекиZotero</a>.</p></li>
<li><p>Поиск по <a href="https://www.crossref.org/">перекрестным ссылкам</a>, <a href="https://datacite.org/">DataCite</a> или <a href="https://pubmed.ncbi.nlm.nih.gov/">PubMed</a>.</p></li>
<li><p>Библиография вашего документа (<code>.bib</code> файл в каталоге вашего документа)</p></li>
</ol>
<p>По сути, визуальный режим использует стандартное представление Pandoc markdown для ссылок (например, <code>[@citation]</code>).</p>
<p>Если вы добавите цитату, используя один из первых трех методов, визуальный редактор автоматически создаст для вас <code>bibliography.bib</code> файл и добавит к нему ссылку. Это также добавит <code>bibliography</code> поле в документ YAML. По мере добавления дополнительных ссылок этот файл будет заполняться их цитатами. Вы также можете напрямую редактировать этот файл, используя многие распространенные форматы библиографии, включая BibLaTeX, BibTeX, EndNote, Medline.</p>
<p>Чтобы создать ссылку в вашем файле <code>.qmd</code> в редакторе исходных текстов, используйте ключ, состоящий из ‘@’ + идентификатор ссылки из файла библиографии. Затем поместите ссылку в квадратные скобки. Вот несколько примеров:</p>
<pre><code>Separate multiple citations with a `;`: Blah blah [@smith04; @doe99].  You can add arbitrary comments inside the square brackets:  Blah blah [see @doe99, pp. 33-35; also @smith04, ch. 1].  Remove the square brackets to create an in-text citation: @smith04  says blah, or @smith04 [p. 33] says blah.  Add a `-` before the citation to suppress the author's name:  Smith says blah [-@smith04].</code></pre>
<p>Когда Quarto отобразит ваш файл, он создаст и добавит библиографию в конец вашего документа. Библиография будет содержать каждую из приведенных ссылок из вашего библиографического файла, но она не будет содержать заголовок раздела. В результате принято заканчивать файл заголовком библиографического раздела, таким как <code># References</code> или <code># Bibliography</code>.</p>
<p>Вы можете изменить стиль ваших цитат и библиографии, сославшись на файл CSL (язык стиля цитирования) в <code>csl</code> поле:</p>
<pre><code>bibliography: rmarkdown.bib csl: apa.csl</code></pre>
<p>Как и в случае с полем библиография, ваш csl-файл должен содержать путь к файлу. Здесь мы предполагаем, что csl-файл находится в том же каталоге, что и файл <code>.qmd</code>. Хорошим местом для поиска файлов стиля CSL для распространенных стилей библиографии является <a href="https://github.com/citation-style-language/styles" class="uri">https://github.com/citation-style-language/styles</a>.</p>
</section>
</section>
<section id="рабочий-процесс" class="level3">
<h3 class="anchored" data-anchor-id="рабочий-процесс"><strong>2.11 Рабочий процесс</strong></h3>
<p>Ранее мы обсуждали базовый рабочий процесс для записи вашего R-кода, при котором вы работаете в интерактивном режиме в <em>консоли</em>, а затем записываете то, что работает, в <em>редакторе сценариев</em>. Кварто объединяет консоль и редактор сценариев, стирая границы между интерактивным исследованием и долгосрочным захватом кода. Вы можете быстро выполнять итерации внутри блока, редактируя и повторно выполняя с помощью Cmd / Ctrl + Shift + Enter. Когда вы довольны, вы двигаетесь дальше и запускаете новый блок.</p>
<p>Кварто важен еще и потому, что в нем так тесно сочетаются проза и код. Это делает его отличным <strong>блокнотом для анализа</strong>, поскольку он позволяет разрабатывать код и записывать свои мысли. Блокнот для анализа преследует многие из тех же целей, что и классический лабораторный блокнот по физическим наукам. IT:</p>
<ul>
<li><p>Записывайте, что вы сделали и почему вы это сделали. Независимо от того, насколько хороша ваша память, если вы не будете записывать то, что вы делаете, наступит время, когда вы забудете важные детали. Запишите их, чтобы не забыть!</p></li>
<li><p>Поддерживает строгое мышление. У вас больше шансов провести тщательный анализ, если вы записываете свои мысли по ходу работы и продолжаете размышлять над ними. Это также экономит ваше время, когда вы в конечном итоге напишете свой анализ, чтобы поделиться им с другими.</p></li>
<li><p>Помогает другим понять вашу работу. Редко удается провести анализ данных самостоятельно, и вы часто будете работать в составе команды. Лабораторный блокнот поможет вам поделиться не только тем, что вы сделали, но и тем, почему вы это сделали, со своими коллегами или коллегами по лаборатории.</p></li>
</ul>
<p>Большая часть полезных советов по эффективному использованию лабораторных записных книжек также может быть применена к записным книжкам для анализа. Мы использовали наш собственный опыт и рекомендации Колина Пуррингтона по лабораторным записным книжкам (<a href="https://colinpurrington.com/tips/lab-notebooks" class="uri">https://colinpurrington.com/tips/lab-notebooks</a>), чтобы предложить следующие советы:</p>
<ul>
<li><p>Убедитесь, что у каждой записной книжки есть описательное название, вызывающее воспоминания название файла и первый абзац, в котором кратко описываются цели анализа.</p></li>
<li><p>Используйте поле даты заголовка YAML, чтобы записать дату начала работы с ноутбуком:</p>
<pre><code>date: 2016-08-23</code></pre>
<p>Используйте формат ISO8601 ГГГГ-ММ-ДД, чтобы не было двусмысленности. Используйте его, даже если вы обычно не записываете даты таким образом!</p></li>
<li><p>Если вы тратите много времени на идею анализа и она оказывается тупиковой, не удаляйте ее! Напишите краткую заметку о том, почему она не удалась, и оставьте ее в блокноте. Это поможет вам избежать того же тупика, когда вы вернетесь к анализу в будущем.</p></li>
<li><p>Как правило, вам лучше выполнять ввод данных за пределами R. Но если вам действительно нужно записать небольшой фрагмент данных, четко изложите его с помощью <a href="https://tibble.tidyverse.org/reference/tribble.html"><code>tibble::tribble()</code></a>.</p></li>
<li><p>Если вы обнаружили ошибку в файле данных, никогда не изменяйте ее напрямую, а вместо этого напишите код для исправления значения. Объясните, почему вы внесли исправление.</p></li>
<li><p>Прежде чем закончить работу над днем, убедитесь, что вы можете выполнить рендеринг записной книжки. Если вы используете кэширование, обязательно очистите кэши. Это позволит вам устранить любые проблемы, пока код еще свеж в вашей памяти.</p></li>
<li><p>Если вы хотите, чтобы ваш код был воспроизводимым в долгосрочной перспективе (т. Е. чтобы вы могли вернуться к его запуску в следующем месяце или в следующем году), вам нужно будет отслеживать версии пакетов, которые использует ваш код. Строгий подход заключается в использовании <strong>renv</strong>, <a href="https://rstudio.github.io/renv/">https://rstudio.github.io/renv/index.html</a> который хранит пакеты в каталоге вашего проекта. Быстрый и грязный взлом заключается в добавлении фрагмента, который выполняется <a href="https://rdrr.io/r/utils/sessionInfo.html"><code>sessionInfo()</code></a> — это не позволит вам легко воссоздавать ваши пакеты такими, какие они есть сегодня, но, по крайней мере, вы будете знать, какими они были.</p></li>
<li><p>Вы собираетесь создать много, много, много аналитических записных книжек в течение своей карьеры. Как вы собираетесь организовать их, чтобы вы могли найти их снова в будущем? Мы рекомендуем хранить их в отдельных проектах и придумать хорошую схему именования.</p></li>
</ul>
</section>
<section id="краткое-содержание" class="level3">
<h3 class="anchored" data-anchor-id="краткое-содержание"><strong>2.12 Краткое содержание</strong></h3>
<p>В этой главе мы познакомили вас с Quarto для разработки и публикации воспроизводимых вычислительных документов, которые включают ваш код и вашу прозу в одном месте. Вы узнали о написании документов Quarto в RStudio с помощью визуального редактора или редактора исходного кода, о том, как работают фрагменты кода и как настраивать параметры для них, как включать рисунки и таблицы в ваши документы Quarto, а также о параметрах кэширования вычислений. Кроме того, вы узнали о настройке параметров заголовка YAML для создания автономных или параметризованных документов, а также о включении ссылок и библиографии. Мы также дали вам несколько советов по устранению неполадок и рабочему процессу.</p>
<p>Хотя этого введения должно быть достаточно, чтобы вы начали работать с Quarto, предстоит еще многому научиться. Quarto все еще относительно молода и продолжает быстро развиваться. Лучшее место, где можно быть в курсе инноваций, - это официальный веб-сайт Quarto: <a href="https://quarto.org/">https://quarto.org</a>.</p>
<p>Есть две важные темы, которые мы здесь не рассмотрели: сотрудничество и детали точного донесения ваших идей до других людей. Совместная работа - жизненно важная часть современной науки о данных, и вы можете значительно упростить свою жизнь, используя инструменты контроля версий, такие как Git и GitHub. Мы рекомендуем Дженни Брайан “Счастливый Git с R”, удобное для пользователя введение в Git и GitHub от пользователей R, написанное Дженни Брайан. Книга находится в свободном доступе в Интернете: <a href="https://happygitwithr.com/">https://happygitwithr.com</a>.</p>
<p>Мы также не коснулись того, что вам на самом деле следует написать, чтобы четко передать результаты вашего анализа. Чтобы улучшить свой текст, мы настоятельно рекомендуем прочитать либо “<a href="https://www.amazon.com/Style-Lessons-Clarity-Grace-12th/dp/0134080416"><em>Стиль: уроки ясности и изящества”</em></a> Джозефа М. Уильямса и Джозефа Бизупа, либо”<a href="https://www.amazon.com/Sense-Structure-Writing-Readers-Perspective/dp/0205296327"><em>чувство структуры: письмо с точки зрения читателя”</em></a> Джорджа Гопена. Обе книги помогут вам понять структуру предложений и абзацев и предоставят инструменты, позволяющие сделать ваш текст более понятным. (Эти книги довольно дорогие, если покупать их новыми, но они используются на многих курсах английского языка, поэтому существует множество дешевых подержанных экземпляров). У Джорджа Гопена также есть несколько коротких статей о написании на <a href="https://www.georgegopen.com/the-litigation-articles.html" class="uri">https://www.georgegopen.com/the-litigation-articles.html</a>. Они предназначены для юристов, но почти все применимо и к специалистам по обработке данных.</p>
</section>
</section>
<section id="форматов-quarto" class="level2">
<h2 class="anchored" data-anchor-id="форматов-quarto">3. <strong>30 форматов Quarto</strong></h2>
<section id="введение-1" class="level3">
<h3 class="anchored" data-anchor-id="введение-1">3.1 Введение</h3>
<p>До сих пор вы видели, что Quarto используется для создания HTML-документов. В этой главе дается краткий обзор некоторых из многих других типов выходных данных, которые вы можете создавать с помощью Quarto.</p>
<p>Существует два способа настройки выходных данных документа:</p>
<ol type="1">
<li>Навсегда, путем изменения заголовка YAML:</li>
</ol>
<div class="sourceCode" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>title<span class="sc">:</span> <span class="st">"Diamond sizes"</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>format<span class="sc">:</span> html</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<ol start="2" type="1">
<li>Временно, путем вызова&nbsp;<code>quarto::quarto_render()</code>&nbsp;вручную:</li>
</ol>
<div class="sourceCode" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>quarto<span class="sc">::</span><span class="fu">quarto_render</span>(<span class="st">"diamond-sizes.qmd"</span>, <span class="at">output_format =</span> <span class="st">"docx"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Это полезно, если вы хотите программно создавать несколько типов выходных данных, поскольку&nbsp;<code>output_format</code>&nbsp;аргумент также может принимать список значений.</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>quarto<span class="sc">::</span><span class="fu">quarto_render</span>(<span class="st">"diamond-sizes.qmd"</span>, <span class="at">output_format =</span> <span class="fu">c</span>(<span class="st">"docx"</span>, <span class="st">"pdf"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="параметры-вывода" class="level3">
<h3 class="anchored" data-anchor-id="параметры-вывода"><strong>3.2 Параметры вывода</strong></h3>
<p>Quarto предлагает широкий выбор выходных форматов. С полным списком вы можете ознакомиться по адресу <a href="https://quarto.org/docs/output-formats/all-formats.html" class="uri">https://quarto.org/docs/output-formats/all-formats.html</a>. Многие форматы имеют общие параметры вывода (например, <code>toc: true</code> для включения оглавления), но другие имеют параметры, зависящие от формата (например, <code>code-fold: true</code> сворачивает фрагменты кода в <code>&lt;details&gt;</code> тег для вывода HTML, чтобы пользователь мог отобразить его по запросу, это неприменимо в документе PDF или Word).</p>
<p>Чтобы переопределить параметры по умолчанию, вам нужно использовать расширенное <code>format</code> поле. Например, если вы хотите отобразить <code>html</code> с плавающим оглавлением, вы должны использовать:</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode yaml code-with-copy"><code class="sourceCode yaml"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">format</span><span class="kw">:</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">html</span><span class="kw">:</span></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">toc</span><span class="kw">:</span><span class="at"> </span><span class="ch">true</span></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">toc_float</span><span class="kw">:</span><span class="at"> </span><span class="ch">true</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Вы даже можете выполнять визуализацию в нескольких выходных данных, предоставив список форматов:</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode yaml code-with-copy"><code class="sourceCode yaml"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">format</span><span class="kw">:</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">html</span><span class="kw">:</span></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">toc</span><span class="kw">:</span><span class="at"> </span><span class="ch">true</span></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">toc_float</span><span class="kw">:</span><span class="at"> </span><span class="ch">true</span></span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">pdf</span><span class="kw">:</span><span class="at"> default</span></span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">docx</span><span class="kw">:</span><span class="at"> default</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Обратите внимание на специальный синтаксис (<code>pdf: default</code>), если вы не хотите переопределять какие-либо параметры по умолчанию.</p>
<p>Для рендеринга во все форматы, указанные в YAML документа, вы можете использовать <code>output_format = "all"</code>.</p>
</section>
<section id="documents" class="level3">
<h3 class="anchored" data-anchor-id="documents">3.3 Documents</h3>
<p>Предыдущая глава была посвящена выходным данным по умолчанию <code>html</code>. Существует несколько базовых вариаций на эту тему, позволяющих создавать документы разных типов. Например:</p>
<ul>
<li><p><code>pdf</code> создает PDF с помощью LaTeX (система верстки документов с открытым исходным кодом), которую вам нужно установить. RStudio предложит вам, если у вас ее еще нет.</p></li>
<li><p><code>docx</code> для документов Microsoft Word (<code>.docx</code>).</p></li>
<li><p><code>odt</code> для текстовых документов OpenDocument (<code>.odt</code>).</p></li>
<li><p><code>rtf</code> для документов в формате Rich Text Format (<code>.rtf</code>).</p></li>
<li><p><code>gfm</code> для документа Markdown со вкусом GitHub (<code>.md</code>).</p></li>
<li><p><code>ipynb</code> для ноутбуков Jupyter (<code>.ipynb</code>).</p></li>
</ul>
<p>Помните, что при создании документа для предоставления доступа лицам, принимающим решения, вы можете отключить отображение кода по умолчанию, установив глобальные параметры в документе YAML:</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode yaml code-with-copy"><code class="sourceCode yaml"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">execute</span><span class="kw">:</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">echo</span><span class="kw">:</span><span class="at"> </span><span class="ch">false</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Для&nbsp;<code>html</code>&nbsp;документов другим вариантом является скрытие фрагментов кода по умолчанию, но их отображение щелчком мыши:</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode yaml code-with-copy"><code class="sourceCode yaml"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">format</span><span class="kw">:</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">html</span><span class="kw">:</span></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">code</span><span class="kw">:</span><span class="at"> </span><span class="ch">true</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="презентации" class="level3">
<h3 class="anchored" data-anchor-id="презентации">3.4 Презентации</h3>
<p>Вы также можете использовать Quarto для создания презентаций. Вы получаете меньше визуального контроля, чем с помощью таких инструментов, как Keynote или PowerPoint, но автоматическая вставка результатов вашего R-кода в презентацию может сэкономить огромное количество времени. Презентации работают путем разделения вашего контента на слайды, причем новый слайд начинается с заголовка каждого второго уровня (<code>##</code>). Кроме того, заголовки первого (<code>#</code>) уровня указывают начало нового раздела со слайдом заголовка раздела, который по умолчанию расположен по центру посередине.</p>
<p>Quarto поддерживает множество форматов представления, в том числе:</p>
<ol type="1">
<li><p><code>revealjs</code> - HTML-презентация с revealjs</p></li>
<li><p><code>pptx</code> - Презентация PowerPoint</p></li>
<li><p><code>beamer</code> - Презентация в формате PDF с использованием LaTeX Beamer.</p></li>
</ol>
<p>Вы можете прочитать больше о создании презентаций с помощью Quarto на <a href="https://quarto.org/docs/presentations/">https://quarto.org/docs/presentations</a>.</p>
</section>
<section id="интерактивность" class="level3">
<h3 class="anchored" data-anchor-id="интерактивность">3.5 Интерактивность</h3>
<p>Как и любой HTML-документ, HTML-документы, созданные с помощью Quarto, также могут содержать интерактивные компоненты. Здесь мы представляем два варианта включения интерактивности в ваши документы Quarto: htmlwidgets и Shiny.</p>
<section id="htmlwidgets" class="level4">
<h4 class="anchored" data-anchor-id="htmlwidgets"><strong>30.5.1 htmlwidgets</strong></h4>
<p>HTML - это интерактивный формат, и вы можете воспользоваться преимуществами этой интерактивности с помощью <strong>htmlwidgets</strong>, R-функций, которые создают интерактивные HTML-визуализации. Для примера возьмите приведенную ниже карту-<strong>брошюру</strong>. Если вы просматриваете эту страницу в Интернете, вы можете перетаскивать карту, увеличивать и уменьшать масштаб и т.д. Очевидно, что вы не можете сделать это в книге, поэтому Quarto автоматически вставляет статический снимок экрана для вас.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(leaflet)</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a><span class="fu">leaflet</span>() <span class="sc">|&gt;</span></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">setView</span>(<span class="fl">174.764</span>, <span class="sc">-</span><span class="fl">36.877</span>, <span class="at">zoom =</span> <span class="dv">16</span>) <span class="sc">|&gt;</span> </span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">addTiles</span>() <span class="sc">|&gt;</span></span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">addMarkers</span>(<span class="fl">174.764</span>, <span class="sc">-</span><span class="fl">36.877</span>, <span class="at">popup =</span> <span class="st">"Maungawhau"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="leaflet html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-ec467fa1bbead6757812" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-ec467fa1bbead6757812">{"x":{"options":{"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}}},"setView":[[-36.877,174.764],16,[]],"calls":[{"method":"addTiles","args":["https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",null,null,{"minZoom":0,"maxZoom":18,"tileSize":256,"subdomains":"abc","errorTileUrl":"","tms":false,"noWrap":false,"zoomOffset":0,"zoomReverse":false,"opacity":1,"zIndex":1,"detectRetina":false,"attribution":"&copy; <a href=\"https://openstreetmap.org/copyright/\">OpenStreetMap<\/a>,  <a href=\"https://opendatacommons.org/licenses/odbl/\">ODbL<\/a>"}]},{"method":"addMarkers","args":[-36.877,174.764,null,null,null,{"interactive":true,"draggable":false,"keyboard":true,"title":"","alt":"","zIndexOffset":0,"opacity":1,"riseOnHover":false,"riseOffset":250},"Maungawhau",null,null,null,null,{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null]}],"limits":{"lat":[-36.877,-36.877],"lng":[174.764,174.764]}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>Самое замечательное в htmlwidgets то, что вам не нужно ничего знать о HTML или JavaScript, чтобы использовать их. Все детали заключены внутри пакета, так что вам не нужно беспокоиться об этом.</p>
<p>Существует множество пакетов, которые предоставляют htmlwidgets, в том числе:</p>
<ul>
<li><p><a href="https://rstudio.github.io/dygraphs"><strong>графики</strong></a> (digraphs) для интерактивной визуализации временных рядов.</p></li>
<li><p><a href="https://rstudio.github.io/DT/"><strong>DT</strong></a> для интерактивных таблиц.</p></li>
<li><p><a href="https://bwlewis.github.io/rthreejs"><strong>threejs</strong></a> для интерактивных 3D-графиков.</p></li>
<li><p><a href="https://rich-iannone.github.io/DiagrammeR"><strong>DiagrammeR</strong></a> для диаграмм (таких как блок-схемы и простые диаграммы связей узлов).</p></li>
</ul>
<p>Чтобы узнать больше о htmlwidgets и просмотреть полный список пакетов, которые их предоставляют, посетите <a href="https://www.htmlwidgets.org/">https://www.htmlwidgets.org</a>.</p>
</section>
<section id="shiny" class="level4">
<h4 class="anchored" data-anchor-id="shiny">3.5.2 Shiny</h4>
<p>htmlwidgets обеспечивают интерактивность на <strong>стороне клиента</strong> — вся интерактивность происходит в браузере независимо от R. С одной стороны, это здорово, потому что вы можете распространять HTML-файл без какой-либо связи с R. Однако это существенно ограничивает ваши возможности в отношении того, что было реализовано в HTML и JavaScript. Альтернативный подход заключается в использовании <strong>shiny</strong>, пакета, который позволяет создавать интерактивность с использованием R-кода, а не JavaScript.</p>
<p>Чтобы вызвать блестящий код из документа кварто, добавьте <code>server: shiny</code> в заголовок YAML:</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode yaml code-with-copy"><code class="sourceCode yaml"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">title</span><span class="kw">:</span><span class="at"> </span><span class="st">"Shiny Web App"</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a><span class="fu">format</span><span class="kw">:</span><span class="at"> html</span></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a><span class="fu">server</span><span class="kw">:</span><span class="at"> shiny</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Затем вы можете использовать функции “ввода” для добавления интерактивных компонентов в документ:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(shiny)</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a><span class="fu">textInput</span>(<span class="st">"name"</span>, <span class="st">"What is your name?"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="form-group shiny-input-container">
<label class="control-label" id="name-label" for="name">What is your name?</label>
<input id="name" type="text" class="shiny-input-text form-control" value="">
</div>
</div>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="fu">numericInput</span>(<span class="st">"age"</span>, <span class="st">"How old are you?"</span>, <span class="cn">NA</span>, <span class="at">min =</span> <span class="dv">0</span>, <span class="at">max =</span> <span class="dv">150</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="form-group shiny-input-container">
<label class="control-label" id="age-label" for="age">How old are you?</label>
<input id="age" type="number" class="shiny-input-number form-control" value="NA" min="0" max="150">
</div>
</div>
</div>
<p>И вам также нужен фрагмент кода с опцией chunk <code>context: server</code>, который содержит код, который должен выполняться на исправном сервере.</p>
<p>Затем вы можете ссылаться на значения с помощью <code>input$name</code> и <code>input$age</code>, и код, который их использует, будет автоматически перезапускаться при каждом их изменении.</p>
<p>Мы не можем показать вам здесь приложение shiny в реальном времени, потому что взаимодействия shiny происходят на <strong>стороне сервера</strong>. Это означает, что вы можете писать интерактивные приложения, не зная JavaScript, но вам нужен сервер для их запуска. Это создает логистическую проблему: приложениям Shiny нужен сервер Shiny для запуска в Сети. Когда вы запускаете приложения Shiny на своем компьютере, Shiny автоматически настраивает для вас сервер Shiny, но вам нужен общедоступный сервер Shiny, если вы хотите опубликовать интерактивность такого рода в Интернете. Это фундаментальный компромисс shiny: в документе shiny можно делать все, что угодно, что вы можете делать в R, но для этого требуется, чтобы кто-то запускал R.</p>
<p>Чтобы узнать больше о Shiny, мы рекомендуем прочитать “Освоение Shiny” Хэдли Уикхема, <a href="https://mastering-shiny.org/">https://mastering-shiny.org</a>.</p>
</section>
</section>
<section id="websites-and-books" class="level3">
<h3 class="anchored" data-anchor-id="websites-and-books">3.6 Websites and books</h3>
<p>С небольшой дополнительной инфраструктурой вы можете использовать кварто для создания полноценного веб-сайта или книги:</p>
<ul>
<li><p>Поместите ваши <code>.qmd</code> файлы в один каталог. <code>index.qmd</code> они станут домашней страницей.</p></li>
<li><p>Добавьте файл YAML с именем<code>_quarto.yml</code>, который обеспечивает навигацию по сайту. В этом файле установите <code>project</code> тип на либо<code>book</code>, либо <code>website</code>, например:</p></li>
</ul>
<div class="sourceCode" id="cb42"><pre class="sourceCode yaml code-with-copy"><code class="sourceCode yaml"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="fu">project</span><span class="kw">:</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">type</span><span class="kw">:</span><span class="at"> book</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Например, следующий&nbsp;<code>_quarto.yml</code>&nbsp;файл создает веб-сайт из трех исходных файлов:&nbsp;<code>index.qmd</code>&nbsp;(домашняя страница),&nbsp;<code>viridis-colors.qmd</code>&nbsp;и&nbsp;<code>terrain-colors.qmd</code>.</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode yaml code-with-copy"><code class="sourceCode yaml"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="fu">project</span><span class="kw">:</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">type</span><span class="kw">:</span><span class="at"> website</span></span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a><span class="fu">website</span><span class="kw">:</span></span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">title</span><span class="kw">:</span><span class="at"> </span><span class="st">"A website on color scales"</span></span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">navbar</span><span class="kw">:</span></span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">left</span><span class="kw">:</span></span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">href</span><span class="kw">:</span><span class="at"> index.qmd</span></span>
<span id="cb43-9"><a href="#cb43-9" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">text</span><span class="kw">:</span><span class="at"> Home</span></span>
<span id="cb43-10"><a href="#cb43-10" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">href</span><span class="kw">:</span><span class="at"> viridis-colors.qmd</span></span>
<span id="cb43-11"><a href="#cb43-11" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">text</span><span class="kw">:</span><span class="at"> Viridis colors</span></span>
<span id="cb43-12"><a href="#cb43-12" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">href</span><span class="kw">:</span><span class="at"> terrain-colors.qmd</span></span>
<span id="cb43-13"><a href="#cb43-13" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">text</span><span class="kw">:</span><span class="at"> Terrain colors</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><code>_quarto.yml</code>&nbsp;Файл, который вам нужен для книги, имеет очень похожую структуру.&nbsp;В следующем примере показано, как можно создать книгу с четырьмя главами, которая отображается в трех разных выходных данных (<code>html</code>,&nbsp;<code>pdf</code>&nbsp;и&nbsp;<code>epub</code>).&nbsp;Еще раз, исходными файлами являются&nbsp;<code>.qmd</code>&nbsp;файлы.</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode yaml code-with-copy"><code class="sourceCode yaml"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="fu">project</span><span class="kw">:</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">type</span><span class="kw">:</span><span class="at"> book</span></span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a><span class="fu">book</span><span class="kw">:</span></span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">title</span><span class="kw">:</span><span class="at"> </span><span class="st">"A book on color scales"</span></span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">author</span><span class="kw">:</span><span class="at"> </span><span class="st">"Jane Coloriste"</span></span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">chapters</span><span class="kw">:</span></span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="kw">-</span><span class="at"> index.qmd</span></span>
<span id="cb44-9"><a href="#cb44-9" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="kw">-</span><span class="at"> intro.qmd</span></span>
<span id="cb44-10"><a href="#cb44-10" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="kw">-</span><span class="at"> viridis-colors.qmd</span></span>
<span id="cb44-11"><a href="#cb44-11" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="kw">-</span><span class="at"> terrain-colors.qmd</span></span>
<span id="cb44-12"><a href="#cb44-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-13"><a href="#cb44-13" aria-hidden="true" tabindex="-1"></a><span class="fu">format</span><span class="kw">:</span></span>
<span id="cb44-14"><a href="#cb44-14" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">html</span><span class="kw">:</span></span>
<span id="cb44-15"><a href="#cb44-15" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">theme</span><span class="kw">:</span><span class="at"> cosmo</span></span>
<span id="cb44-16"><a href="#cb44-16" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">pdf</span><span class="kw">:</span><span class="at"> default</span></span>
<span id="cb44-17"><a href="#cb44-17" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">epub</span><span class="kw">:</span><span class="at"> default</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Мы рекомендуем вам использовать проект RStudio для ваших веб-сайтов и книг. На основе <code>_quarto.yml</code> файла RStudio распознает тип проекта, над которым вы работаете, и добавит вкладку сборки в IDE, которую вы можете использовать для рендеринга и предварительного просмотра ваших веб-сайтов и книг. С помощью <code>quarto::render()</code> также можно отображать как веб-сайты, так и книги.</p>
<p>Подробнее читайте на <a href="https://quarto.org/docs/websites" class="uri">https://quarto.org/docs/websites</a> о веб-сайтах в формате кварто и <a href="https://quarto.org/docs/books" class="uri">https://quarto.org/docs/books</a> о книгах.</p>
</section>
<section id="другие-форматы" class="level3">
<h3 class="anchored" data-anchor-id="другие-форматы"><strong>3.7 Другие форматы</strong></h3>
<p>Quarto предлагает еще больше форматов вывода:</p>
<ul>
<li><p>Вы можете писать журнальные статьи, используя шаблоны журналов Кварто: <a href="https://quarto.org/docs/journals/templates.html" class="uri">https://quarto.org/docs/journals/templates.html</a>.</p></li>
<li><p>Документы в формате кварто можно выводить в записные книжки Jupyter с помощью <code>format: ipynb</code>: <a href="https://quarto.org/docs/reference/formats/ipynb.html" class="uri">https://quarto.org/docs/reference/formats/ipynb.html</a>.</p></li>
</ul>
<p>Смотрите <a href="https://quarto.org/docs/output-formats/all-formats.html" class="uri">https://quarto.org/docs/output-formats/all-formats.html</a> Список еще большего количества форматов.</p>
</section>
<section id="резюме" class="level3">
<h3 class="anchored" data-anchor-id="резюме"><strong>3.8 Резюме</strong></h3>
<p>В этой главе мы представили вам множество вариантов передачи ваших результатов с помощью Quarto, от статических и интерактивных документов до презентаций для веб-сайтов и книг.</p>
<p>Чтобы узнать больше об эффективной коммуникации в этих различных форматах, мы рекомендуем следующие ресурсы:</p>
<ul>
<li><p>Чтобы улучшить свои навыки презентации, попробуйте <a href="https://presentationpatterns.com/"><em>шаблоны</em></a> презентаций, разработанные Нилом Фордом, Мэтью Макколлоу и Натаниэлем Шуттой. Он предоставляет набор эффективных шаблонов (как низкоуровневых, так и высокоуровневых), которые вы можете применять для улучшения своих презентаций.</p></li>
<li><p>Если вы выступаете с научными докладами, вам может понравиться <a href="https://github.com/jtleek/talkguide"><em>руководство Leek group по выступлениям</em></a>.</p></li>
<li><p>Мы не проходили его сами, но слышали много хорошего об онлайн-курсе Мэтта Макгаррити по публичным выступлениям: <a href="https://www.coursera.org/learn/public-speaking" class="uri">https://www.coursera.org/learn/public-speaking</a>.</p></li>
<li><p>Если вы создаете много информационных панелей, обязательно ознакомьтесь с <a href="https://www.amazon.com/Information-Dashboard-Design-Effective-Communication/dp/0596100167"><em>проектом информационной панели Стивена Фауса: эффективная визуальная передача данных</em></a>. Это поможет вам создавать действительно полезные панели мониторинга, а не просто красивые на вид.</p></li>
<li><p>Для эффективного донесения ваших идей часто необходимы некоторые знания в области графического дизайна. Книга Робина Уильямса <a href="https://www.amazon.com/Non-Designers-Design-Book-4th/dp/0133966151"><em>“Дизайн для не-дизайнера”</em></a> - отличное место для начала.</p></li>
</ul>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>